Table of Contents
=================
   * [Εγκατάσταση](#εγκατάσταση)
      * [Απαιτήσεις](#απαιτήσεις)
      * [Οδηγίες Εγκατάστασης](#οδηγίες-εγκατάστασης)
   * [Περιγραφή API](#περιγραφή-api)
      * [Methods](#methods)
         * [Board](#board)
            * [Ανάγνωση Board](#ανάγνωση-board)
            * [Αρχικοποίηση Board](#αρχικοποίηση-board)
         * [Piece](#piece)
            * [Ανάγνωση Θέσης/Πιονιού](#ανάγνωση-θέσηςπιονιού)
            * [Μεταβολή Θέσης Πιονιού](#μεταβολή-θέσης-πιονιού)
         * [Player](#player)
            * [Ανάγνωση στοιχείων παίκτη](#ανάγνωση-στοιχείων-παίκτη)
            * [Καθορισμός στοιχείων παίκτη](#καθορισμός-στοιχείων-παίκτη)
         * [Status](#status)
            * [Ανάγνωση κατάστασης παιχνιδιού](#ανάγνωση-κατάστασης-παιχνιδιού)
      * [Entities](#entities)
         * [Board](#board-1)
         * [Players](#players)
         * [Game_status](#game_status)


# Demo Page

Μπορείτε να κατεβάσετε τοπικά ή να επισκευτείτε την σελίδα: https://users.iee.ihu.gr/~iee2019037/ADISE23_2019037



# Εγκατάσταση

## Απαιτήσεις

* Apache2
* Mysql Server
* php

## Οδηγίες Εγκατάστασης

* Κάντε clone το project σε κάποιον φάκελο <br/>
  `$ git clone https://github.com/iee-ihu-gr-course1941/ADISE23_2019037.git`

* Βεβαιωθείτε ότι ο φάκελος είναι προσβάσιμος από τον Apache Server. πιθανόν να χρειαστεί να καθορίσετε τις παρακάτω ρυθμίσεις.

* Θα πρέπει να δημιουργήσετε στην Mysql την βάση με όνομα 'battleships' και να φορτώσετε σε αυτήν την βάση τα δεδομένα από το αρχείο schema.sql

* Θα πρέπει να φτιάξετε το αρχείο lib/config_local.php το οποίο να περιέχει:
```
    <?php
	$DB_PASS = 'κωδικός';
	$DB_USER = 'όνομα χρήστη';
    ?>
```


# Περιγραφή Παιχνιδιού

Η «Ναυμαχία» είναι γνωστή ως ένα παιχνίδι ανάμεσα σε δύο παίχτες, όπου ο ένας προσπαθεί να μαντέψει τις κινήσεις του στόλου του άλλου με σκοπό να βυθίσει όλα του τα πλοία. Οι δύο παίκτες έχει ο καθένας από ένα ταμπλό 10χ10 θέσεων για να τοποθετήσει τα πλοία του χωρίς να το ξέρει ο αντίπαλος. Μετά την τοπέθετηση των 5 πλοίων του κάθε παίκτη , ο καθένας προσπαθεί να μαντέψει σε ποιο σημείο έχει τοποθετήσει ο αντίπαλος τα πλοία του , εν αλλάζοντας κάθε φορά σειρά μέχρι κάποιος παίκτης να μην έχει κάποιο διαθέσιμο ακόμα πλοίο με αποτέλεσμα να χάνει.

Η εφαρμογή έχει αναπτυχθεί μόνο μέχρι το API της και όχι γραφικά και html.

Η βάση περίεχει τον πίνακα board που περίεχει identifier για την διαχώριση των boards , τις συντεταγμένες και την κάτασταση των κελιών. Τον πίνακα Players με χαρακτηριστικά των παικτών. Τον πίνακα board_empty που περιέχει τον αρχικό πίνακα board για την εύκολη αρχικοποίηση του για καινούργιο παιχνίδι, τον πίνακα game_status που έχει πληροφορίες για την κατάσταση του παιχνιδιού και τέλος την procedure clean_board που χρησιμοποιεί το board_empty για να φέρει τον board στην αρχική του κατάσταση.

# Περιγραφή API

## Methods


### Board
#### Ανάγνωση Board

```
GET /board/
```

Επιστρέφει το [Board](#Board).

#### Αρχικοποίηση Board
```
POST /board/
```

Αρχικοποιεί το Board, δηλαδή το παιχνίδι. Γίνονται reset τα πάντα σε σχέση με το παιχνίδι.
Επιστρέφει το [Board](#Board).

### Prep

#### Αρχικοποίηση πλοίων παικτών

```
POST /board/prep/:c1/:c2/:c3/:c4/:c5/:b1/:b2/:b3/:b4/:d1/:d2/:d3/:s1/:s2/:s3/:pb1/:pb2/:player_id
```

Αρχικοποίει τα πλοια του παικτη με τη σειρά Carrier (5) , Battleship (4) , Destroyer (3), Submarine (3) , Patrol boat(2), στις συντεταγμένες που έδωσε ο κάθε παικτης στις παραμέτρους :c1/:c2/:c3/:c4/:c5/:b1/:b2/:b3/:b4/:d1/:d2/:d3/:s1/:s2/:s3/:pb1/:pb2/:player_id. Η μορφή των συντεταγμένων είναι "Καθετα κελία/Οριζόντια κελία" όπου κάθετα κελία είναι οι αριθμοί 1...10 και οριζόντια κελια τα γράμματα του λατινικού αλφαβήτου A...J Π.χ. 5J και οπου player_id 'P1' είτε 'P2'

### Handle_attack

#### Επίθεση παίκτη

```
POST /board/attack/:pos/:player_id/
```

Παίρνει ως ορίσματα την τοποθεσία που μαντεύει ο παικτής για επίθεση και ποιος παίκτης την κάνει όπου :pos μπορεί να είναι μια θέση του πίνακα πχ. 3D και :player_id είτε P1/P2. Τσεκάρει αν είναι η σειρά του παίκτη που δώθηκε και αν υπάρχει στην συγκεκριμένη θέση πλοίο του αντιπάλου παίκτη , ενημέρωνει την σειρά του παίκτη και κάλει τις check_abort, check_end για να ενημερώσει το game_status αν χρειάζεται.

### Player

#### Ανάγνωση στοιχείων παίκτη
```
GET /players/
```

Επιστρέφει τα στοιχεία του παίκτη p ή όλων των παικτών αν παραληφθεί. Το p μπορεί να είναι 'P1' ή 'P2'.

#### Καθορισμός στοιχείων παίκτη
```
POST /players/:p
```
Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `username`        | Το username για τον παίκτη p. | yes        |


Επιστρέφει τα στοιχεία του παίκτη p και ένα token. Το token πρέπει να το χρησιμοποιεί ο παίκτης καθόλη τη διάρκεια του παιχνιδιού.

### Status

#### Ανάγνωση κατάστασης παιχνιδιού
```
GET /status/
```

Επιστρέφει το στοιχείο [Game_status](#Game_status).



## Entities


### Board
---------

Το board είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `player_id`                      | Χαρακτηριστικό για τον διαχωρισμό των board             | 'P1','P2'                              |
| `ColRow`                      |    H συντεταγμένη των κάθετων και οριζόντιων κελιών         |  1A...10J                            |
| `shipType`                |   Οι τύποι των πλοίων         | 'Carrier','Battlehsip','Destroyer','Submarine','Patrol boat'                      |
| `position`            |    Η κατάσταση του συγκεκριμένου κελιού                      | 'empty','occupied','hit'              |

### Players
---------

O κάθε παίκτης έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `username`               | Όνομα παίκτη                                 | String                              |
| `player_id`            | Ο αριθμός του παίκτη                | 'P1','P2'                             |
| `token  `                | To κρυφό token του παίκτη. Επιστρέφεται μόνο τη στιγμή της εισόδου του παίκτη στο παιχνίδι | HEX |

### Game_status
---------

H κατάσταση παιχνιδιού έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `status  `               | Κατάσταση             | 'not active', 'initialized', 'started', 'ended', 'aborted'     |
| `p_turn`                 | Ποιου παίκτη είναι η σειρά       | 'P1','P2',null                              |
| `result`                 |  Ποίος παίκτης κέρδισε |'P1','P2',null                              |
| `last_change`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παιχνιδιού         | timestamp |