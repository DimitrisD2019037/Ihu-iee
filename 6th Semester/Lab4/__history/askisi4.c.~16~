#include <main-proteus.h> 
#byte PORTD =0xF83 

//d???s? s??a?t?se??
void init(void);
void ext_int2(void); 

void main(){
   init(); //?a?? t?? s????t?s? p?? ???e? a?????p???se??   
   while(TRUE){   //flash 8 LEDs
      PORTD=0b11111111;    
      delay_ms(300);                                                     
      PORTD=0b00000000;
      delay_ms(300);
   }                                                                  
}                                                     

//???t??a a?????p???se??
void init(){      
   set_tris_d(0x00);       //? PORTD ???eta? ???d??                                       
   PORTD = 0b00000000;     //a?????p???s? p??ta? 
   ext_int_edge(2, H_TO_L);  
   //???sµ?? d?a??p?? ap? t? RB2
   //?a? se µet?ßas? ap? ?????? 1 se ?????? 0
   enable_interrupts(GLOBAL);
   
   //e?e???p???s? "?e????? d?a??pt?"
   enable_interrupts(INT_EXT2);
   //e?e???p???s? d?a??p?? ap? t? RB2
}                                                 

//???t??a e??p???t?s?? d?a??p?? ap? t? RB2
#INT_EXT2                                                                      
void ext_int2() {   
//d?µ??????a ?????µe??? te?e?a?
   int8 i;
   for(i=1;i<=7;i++){
      delay_ms(250);
      PORTD = PORTD/2;
      }  
    for(i=7;i>=1;i--){
      delay_ms(250);          
      PORTD= PORTD*2;
      }  
}


